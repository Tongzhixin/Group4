{% extends "base.html" %}
{% load static %}

{% block title %} 学生信息修改 {% endblock title %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-12">
                <br>
                {% if request.user.student_profile.avatar %}
                    <div class="col-md-4">头像</div>
                    <img src="{{ request.user.student_profile.avatar.url }}" style="max-width: 20%; border-radius: 15%;" class="col-md-4">
                {% endif %}
                <br>
                <br>
                <form ... enctype="multipart/form-data">{% csrf_token %}
                    <!-- avatar -->
                    <div class="form-group">
                        <label for="avatar">上传头像</label>
                        <input type="file" class="form-control-file" name="avatar" id="avatar">
                    </div>
                </form>
                <div class="col-md-4">学生姓名：{{ request.user.username }}</div>
                <br>
                <form method="post" action=".">
                    {% csrf_token %}
                    <div class="form-group col-md-4">
                        <label for="age">年龄</label>
                        <input type="text" class="form-control" id="age" name="age"
                               value="{{ request.user.student_profile.age }}">
                    </div>

                    <div class="form-group col-md-4">
                        <label for="gender">性别</label>
                        <select class="form-control" id="gender" name="gender">
                            <!-- 使用模板语言来根据性别的不同显示不同预设值的下拉菜单 -->
                            {% if request.user.student_profile.gender == 'M' %}
                                <option value="M" selected>男</option>
                                <option value="F">女</option>
                            {% else %}
                                <option value="M">男</option>
                                <option value="F" selected>女</option>
                            {% endif %}
                        </select>
                    </div>

                    <div class="form-group col-md-4">
                        <label for="grade">年级</label>
                        <select class="form-control" id="grade" name="grade">
                            <!-- 根据当前用户的年级来规定下拉菜单预设值 -->
                            <script language="javascript">
                                const grades = ["小学一年级至三年级", "小学四年级至六年级", "初一", "初二", "初三", "高一", "高二", "高三", "其他"];
                                for (var i = 0; i < 9; i++) {
                                    // 获取模板变量
                                    var g = {{ request.user.student_profile.grade }};
                                    // ===代表数值和类型都相同 pycharm的建议 我并不懂
                                    if (i === g) {
                                        // 写入html输出
                                        document.write("<option value=\"" + i + "\" selected>" + grades[i] + "</option>");
                                    } else document.write("<option value=\"" + i + "\" >" + grades[i] + "</option>");
                                }
                            </script>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary">提交</button>
                </form>
            </div>
        </div>
    </div>
{% endblock content %}
